<<<<<<< HEAD
# MiniRAG-V
=======
# å¤šæ¨¡æ€ VLM + RAG å®‰å…¨åˆ†æç³»ç»Ÿ

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªæ™ºèƒ½å®‰å…¨åˆ†æç³»ç»Ÿï¼Œç»“åˆäº†**è§†è§‰è¯­è¨€æ¨¡å‹ (VLM)** ä¸ **æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG)** æŠ€æœ¯ã€‚ç³»ç»Ÿåˆ©ç”¨ **Chinese-CLIP** è¿›è¡Œå›¾åƒç‰¹å¾æå–ï¼Œä½¿ç”¨ **MiniMind2-V** è¿›è¡Œè§†è§‰ç†è§£ï¼Œé€šè¿‡ **Milvus** å‘é‡æ•°æ®åº“æ£€ç´¢ç›¸ä¼¼çš„å†å²äº‹æ•…æ¡ˆä¾‹å’Œç›¸å…³å®‰å…¨æ³•è§„ï¼Œæä¾›å…¨é¢çš„å®‰å…¨åˆ†æå’Œè§£é‡Šã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

- **ä»¥å›¾æœå›¾ (Image-to-Image Retrieval)**: ä¸Šä¼ å›¾ç‰‡ï¼Œåˆ©ç”¨é«˜ç»´è§†è§‰åµŒå…¥ (Chinese-CLIP ViT-B-16) æ£€ç´¢å†å²ä¸Šç›¸ä¼¼çš„äº‹æ•…æ¡ˆä¾‹ã€‚
- **å¤šæ¨¡æ€ RAG åˆ†æ**: é€šè¿‡æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ï¼ˆç›¸ä¼¼æ¡ˆä¾‹ + æ³•è§„ï¼‰å¢å¼º VLM çš„ç”Ÿæˆèƒ½åŠ›ï¼Œæä¾›å‡†ç¡®ã€åŸºäºäº‹å®çš„åˆ†æç»“æœã€‚
- **æ³•è§„åŒ¹é…**: æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æ£€ç´¢ç›¸å…³çš„å®‰å…¨æ³•è§„å’Œæ³•å¾‹æ ‡å‡†ã€‚
- **é«˜æ€§èƒ½å‘é‡æ£€ç´¢**: ç”± **Milvus** æ”¯æŒçš„å¤§è§„æ¨¡å‘é‡ç›¸ä¼¼åº¦æœç´¢ã€‚
- **ç°ä»£åŒ– API**: åŸºäº **FastAPI** æ„å»ºï¼Œæä¾›å¥å£®ä¸”å¯æ‰©å±•çš„ RESTful æ¥å£ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: Python 3.12+, FastAPI
-   **å‘é‡æ•°æ®åº“**: Milvus 2.x
-   **æ¨¡å‹**:
    -   **Embedding**: Chinese-CLIP (ViT-B-16)
    -   **VLM**: MiniMind2-V
-   **ML æ¡†æ¶**: PyTorch, Transformers
-   **ä¾èµ–ç®¡ç†**: uv

## ğŸ“‹ å‰ç½®æ¡ä»¶

å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹ç¯å¢ƒï¼š

-   **Python 3.12+**
-   **Milvus æœåŠ¡**: è¿è¡Œä¸­çš„ Milvus å®ä¾‹ï¼ˆé€šå¸¸é€šè¿‡ Docker è¿è¡Œï¼‰ã€‚
    -   [Milvus å®‰è£…æŒ‡å—](https://milvus.io/docs/install_standalone-docker.md)
-   **CUDA GPU**: å¼ºçƒˆå»ºè®®ç”¨äºæ¨¡å‹æ¨ç† (Chinese-CLIP & MiniMind2-V)ã€‚

## ğŸ“¦ å®‰è£…æŒ‡å—

1.  **å…‹éš†ä»“åº“**
    ```bash
    git clone <repository_url>
    cd my_project
    ```

2.  **å®‰è£…ä¾èµ–**
    ä½¿ç”¨ `uv` (æ¨è):
    ```bash
    uv sync
    ```
    æˆ–è€…ä½¿ç”¨æ ‡å‡† `pip`:
    ```bash
    pip install .
    ```

3.  **æ¨¡å‹å‡†å¤‡**
    ç¡®ä¿æ¨¡å‹æ”¾ç½®åœ¨ `config.yaml` ä¸­é…ç½®çš„ `model/` ç›®å½•ä¸‹ï¼š
    -   `model/vision_model/chinese-clip-vit-base-patch16`
    -   `model/MiniMind2-V`

## âš™ï¸ é…ç½®è¯´æ˜

ç³»ç»Ÿé€šè¿‡ `config.yaml` è¿›è¡Œé…ç½®ã€‚å…³é”®è®¾ç½®åŒ…æ‹¬ï¼š

-   **Milvus è¿æ¥**: `host`, `port`
-   **Embedding æ¨¡å‹**: `model_name`, `dim` (512), `device`
-   **æ£€ç´¢è®¾ç½®**: `top_k`, `score_threshold`
-   **VLM è®¾ç½®**: `model_path`, `generation` å‚æ•°

## ğŸ—„ï¸ æ•°æ®åº“åˆå§‹åŒ–

åˆå§‹åŒ– Milvus é›†åˆå¹¶å¯¼å…¥æ•°æ®ï¼š

1.  **åˆå§‹åŒ–é›†åˆ**:
    ```bash
    python scripts/init_milvus_collections.py
    ```

2.  **å¯¼å…¥æ•°æ® (å¯é€‰)**:
    å¦‚æœæœ‰æ•°æ®åœ¨ `dataset/` ä¸­ï¼Œè¿è¡Œï¼š
    ```bash
    python scripts/init_milvus_collections.py --ingest --ingest-kb
    ```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¯åŠ¨æœåŠ¡å™¨

è¿è¡Œ FastAPI åº”ç”¨ï¼š

```bash
python run.py
```
æœåŠ¡å™¨å°†åœ¨ `http://0.0.0.0:8000` å¯åŠ¨ã€‚

### API æ–‡æ¡£

æœåŠ¡å™¨å¯åŠ¨åï¼Œå¯ä»¥è®¿é—®äº¤äº’å¼ API æ–‡æ¡£ï¼š

-   **Swagger UI**: [http://localhost:8000/docs](http://localhost:8000/docs)
-   **ReDoc**: [http://localhost:8000/redoc](http://localhost:8000/redoc)

### å…³é”®æ¥å£

-   **`GET /v1/info`**: æ£€æŸ¥ç³»ç»ŸçŠ¶æ€ã€‚
-   **`POST /v1/search/image`**: ä½¿ç”¨å›¾ç‰‡æœç´¢ç›¸ä¼¼æ¡ˆä¾‹ã€‚
-   **`POST /v1/search/image-with-regulations`**: æœç´¢æ¡ˆä¾‹åŠè¯­ä¹‰ç›¸å…³çš„æ³•è§„ã€‚
-   **`POST /v1/analyze`**: å¯¹ä¸Šä¼ å›¾ç‰‡æ‰§è¡Œå®Œæ•´çš„ RAG + VLM åˆ†æã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
my_project/
â”œâ”€â”€ config.yaml          # ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”œâ”€â”€ run.py               # åº”ç”¨å¯åŠ¨å…¥å£
â”œâ”€â”€ pyproject.toml       # Python ä¾èµ–ç®¡ç† (uv)
â”œâ”€â”€ src/                 # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ api/             # API è·¯ç”±ä¸ schemas
â”‚   â”œâ”€â”€ milvus/          # Milvus å®¢æˆ·ç«¯ä¸å·¥å…·
â”‚   â”œâ”€â”€ services/        # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (AI, Search, System)
â”‚   â”œâ”€â”€ inference/       # æ¨¡å‹æ¨ç†é€»è¾‘
â”‚   â””â”€â”€ main.py          # FastAPI åº”ç”¨å·¥å‚
â”œâ”€â”€ scripts/             # å·¥å…·è„šæœ¬ (åˆå§‹åŒ–, æ•°æ®æ¸…æ´—)
â”œâ”€â”€ model/               # æ¨¡å‹æƒé‡ç›®å½•
â”œâ”€â”€ dataset/             # æ•°æ®ç›®å½•
â””â”€â”€ tests/               # å•å…ƒæµ‹è¯•
```
>>>>>>> dev
